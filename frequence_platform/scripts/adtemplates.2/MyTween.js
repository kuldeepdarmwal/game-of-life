/* Copr. (c) 2011, 4Mads */
var MyTween=Class.extend({init:function(a,b,c){this._timeStart=MyTween.getTime();this._duration=a;this._fnUpdate=b;this._fnEnd=c;MyTween.addTween(this);this._fnUpdate(0,a)}},{_rgTweens:[],_cTicks:0,addTween:function(a){this._rgTweens.push(a);a._fnUpdate(0,a._duration);this._rgTweens.length==1&&this.startTimer()},removeTweenAt:function(a){this._rgTweens.splice(a,1)},onEnterFrame:function(){for(var e=this.getTime(),c=this._rgTweens.length-1;c>=0;c--){var a=this._rgTweens[c],d=(e-a._timeStart)/1e3,b=a._duration;if(d>b)d=b;a._fnUpdate(d,b);if(d>=b){a._fnEnd!=null&&a._fnEnd();this.removeTweenAt(c)}}this._rgTweens.length<=0&&this.stopTimer();MySprite.clean();this._idTimer&&window.requestAnimFrame(MySprite.bindCall(this,this.onEnterFrame))},startTimer:function(){this.stopTimer();this._cTicks=0;if(!this._idTimer){this._idTimer=1;window.requestAnimFrame(MySprite.bindCall(this,this.onEnterFrame))}},stopTimer:function(){if(this._idTimer)this._idTimer=0},getTime:function(){return(new Date).getTime()},tweenProperty:function(d,c,b,f,g,a,e){return MyTween.tweenSetter(MyTween.setProperty(d,c),b,f,g,a,e)},tweenSetter:function(c,b,e,f,a,d){return new MyTween(a,MyTween.apply(c,MyTween.ease(b,e,f)),d)},setProperty:function(b,a){var c=b["set"+a[0].toUpperCase()+a.substr(1)];return typeof c=="function"?MySprite.bindCall(b,c):function(c){b[a]=c}},ease:function(b,a,d){var c=d-a;return function(e,d){return b(e,a,c,d)}},apply:function(b,a){return function(d,c){b(a(d,c))}},moveContent:function(h,a,d,e,b,c,i,j,f,g){return function(l,k){h.moveContent(a(l,d,i-d,k),a(l,e,j-e,k),a(l,b,f-b,k),a(l,c,g-c,k))}}})