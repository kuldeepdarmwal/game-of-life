{"version":3,"sources":["directives/page-frame.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;YAWA;gBAMC,mBAAoB,EAAc,EAAiC,MAAM;oBAArD,OAAE,GAAF,EAAE,CAAY;oBAAiC,WAAM,GAAN,MAAM,CAAA;oBAF/D,eAAU,GAAG,IAAI,mBAAY,EAAE,CAAC;oBAGzC,IAAI,CAAC,GAAG,GAAG,EAAE,CAAC,aAAa,CAAC;oBAC5B,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBAC5B,CAAC;gBAED,0BAAM,GAAN;oBACC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;oBAC3B,IAAI,CAAC,QAAQ,EAAE,CAAC;gBACjB,CAAC;gBAED,4BAAQ,GAAR;oBACC,IAAI,eAAe,GAAG,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC;oBAE3C,IAAI,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,aAAa,CAAC,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;oBAClE,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;wBACV,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,WAAW,CAAC;wBAClC,IAAI,CAAC,YAAY,CAAC,OAAO,EAAE,WAAW,CAAC,CAAC;oBACzC,CAAC;oBAAC,IAAI,CAAC,CAAC;wBACP,IAAI,GAAG,EAAE,WAAW,EAAE,IAAI,CAAC,MAAM,CAAC,UAAU,EAAE,YAAY,EAAE,IAAI,CAAC,MAAM,CAAC,WAAW,EAAE,CAAC;oBACvF,CAAC;oBAED,IAAI,KAAK,GAAG,eAAe,GAAG,IAAI,CAAC,WAAW,CAAC;oBAC/C,EAAE,CAAC,CAAC,KAAK,IAAI,CAAC,CAAC,CAAC,CAAC;wBAChB,IAAI,CAAC,GAAG,CAAC,aAAa,CAAC,QAAQ,CAAC,IAAI,CAAC,YAAY,CAAC,OAAO,EAAE,+BAA+B,CAAC,CAAC;wBAC5F,MAAM,CAAC,IAAI,CAAC;oBACb,CAAC;oBAED,EAAE,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,aAAa,CAAC,QAAQ,CAAC,IAAI,KAAK,IAAI,CAAC,CAAC,CAAC;wBACnD,IAAI,CAAC,GAAG,CAAC,aAAa,CAAC,QAAQ,CAAC,IAAI,CAAC,YAAY,CAAC,OAAO,EAAE,sBACjD,IAAI,CAAC,WAAW,sCACN,KAAK,yEAEP,CAAC,CAAC;oBACrB,CAAC;oBAED,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC,OAAO,EAAE,aAAW,IAAI,CAAC,YAAY,GAAG,KAAK,OAAI,CAAC,CAAC;gBAC1E,CAAC;gBAtCD;oBAAC,aAAM,EAAE;;6DAAA;gBAXV;oBAAC,gBAAS,CAAC;wBACV,QAAQ,EAAE,mBAAmB;wBAC7B,IAAI,EAAE;4BACL,QAAQ,EAAE,UAAU;4BACpB,iBAAiB,EAAE,kBAAkB;yBACrC;qBACD,CAAC;+BAOoC,aAAM,CAAC,sBAAa,CAAC;;6BAPzD;gBA6CF,gBAAC;YAAD,CA5CA,AA4CC,IAAA;YA5CD,iCA4CC,CAAA","file":"directives/page-frame.js","sourcesContent":["import {Directive, ElementRef, Output, EventEmitter, Inject} from 'angular2/core';\n\nimport {ConfigService} from '../services/config';\n\n@Directive({ \n\tselector: 'iframe[pageframe]',\n\thost: {\n\t\t'(load)': 'onLoad()',\n\t\t'(window:resize)': 'onResize($event)'\n\t}\n})\nexport class PageFrame {\n\tprivate _el: HTMLElement;\n\tprivate pageWidth: number;\n\n\t@Output() onPageLoad = new EventEmitter();\n\n\tconstructor(private el: ElementRef, @Inject(ConfigService) private config) {\n\t\tthis._el = el.nativeElement;\n\t\tthis.onPageLoad.emit(this);\n\t}\n\n\tonLoad() {\n\t\tthis.onPageLoad.emit(this);\n\t\tthis.onResize();\n\t}\n\n\tonResize() {\n\t\tvar container_width = this._el.offsetWidth;\n\n\t\tvar page = this._el.contentWindow.document.querySelector('.page');\n\t\tif (page) {\n\t\t\tthis.pageWidth = page.offsetWidth;\n\t\t\tpage.setAttribute('style', `margin:0;`);\n\t\t} else {\n\t\t\tpage = { offsetWidth: this.config.page_width, offsetHeight: this.config.page_height };\n\t\t}\n\n\t\tvar ratio = container_width / page.offsetWidth;\n\t\tif (ratio >= 1) {\n\t\t\tthis._el.contentWindow.document.body.setAttribute('style', `transform: none; width: 100%;`);\n\t\t\treturn true;\n\t\t}\n\n\t\tif (this._el.contentWindow.document.body !== null) {\n\t\t\tthis._el.contentWindow.document.body.setAttribute('style', `\n\t\t\t\twidth: ${page.offsetWidth}px;\n\t\t\t\ttransform: scale(${ratio});\n\t\t\t\ttransform-origin: 0px 0px 0px;\n\t\t\t\toverflow: hidden`);\n\t\t}\n\n\t\tthis._el.setAttribute('style', `height: ${page.offsetHeight * ratio}px`);\n\t}\n\n}"],"sourceRoot":"/source/"}