{"version":3,"sources":["services/page.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;YAQA;gBACC,mBACQ,EAAU,EACV,MAAc,EACd,QAAgB,EAChB,aAAsB;oBAHtB,OAAE,GAAF,EAAE,CAAQ;oBACV,WAAM,GAAN,MAAM,CAAQ;oBACd,aAAQ,GAAR,QAAQ,CAAQ;oBAChB,kBAAa,GAAb,aAAa,CAAS;gBAAI,CAAC;gBANpC;oBAAC,iBAAU,EAAE;;6BAAA;gBAOb,gBAAC;YAAD,CANA,AAMC,IAAA;YAND,iCAMC,CAAA;YAGD;gBACC,qBAAoB,IAAU,EAAiC,MAAM;oBAAjD,SAAI,GAAJ,IAAI,CAAM;oBAAiC,WAAM,GAAN,MAAM,CAAA;gBAAI,CAAC;gBAE1E,8BAAQ,GAAR;oBACC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,sBAAoB,IAAI,CAAC,MAAM,CAAC,WAAa,CAAC;yBACjE,GAAG,CAAC,UAAA,GAAG;wBACP,MAAM,CAAC,GAAG,CAAC,IAAI,EAAE,CAAC,GAAG,CAAC,UAAC,IAAI;4BAC1B,MAAM,CAAC,IAAI,SAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;wBAC/E,CAAC,CAAC,CAAA;oBACH,CAAC,CAAC;yBACD,KAAK,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;gBAC3B,CAAC;gBAED,sCAAgB,GAAhB;oBACC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,+BAA6B,IAAI,CAAC,MAAM,CAAC,WAAa,CAAC;yBAC1E,GAAG,CAAC,UAAA,GAAG;wBACP,MAAM,CAAC,GAAG,CAAC,IAAI,EAAE,CAAC,GAAG,CAAC,UAAC,IAAI;4BAC1B,MAAM,CAAC,IAAI,SAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC;wBACnG,CAAC,CAAC,CAAA;oBACH,CAAC,CAAC;yBACD,KAAK,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;gBAC3B,CAAC;gBAED,6BAAO,GAAP,UAAQ,MAAc,EAAE,WAAmB;oBAC1C,IAAI,IAAI,GAAG,IAAI,CAAC,cAAc,CAAC,EAAC,WAAW,EAAE,IAAI,CAAC,MAAM,CAAC,WAAW,EAAE,MAAM,EAAE,MAAM,EAAE,WAAW,EAAE,WAAW,EAAC,CAAC,CAAC;oBACjH,IAAI,OAAO,GAAG,IAAI,cAAO,CAAC,EAAE,cAAc,EAAE,kDAAkD,EAAE,CAAC,CAAC;oBAClG,IAAI,OAAO,GAAG,IAAI,qBAAc,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;oBAEvD,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,qBAAqB,EAAE,IAAI,EAAE,OAAO,CAAC;yBACzD,GAAG,CAAC,UAAA,GAAG;wBACP,IAAI,IAAI,GAAG,GAAG,CAAC,IAAI,EAAE,CAAC;wBACtB,MAAM,CAAC,IAAI,SAAS,CAAC,IAAI,CAAC,EAAE,EAAE,MAAM,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAA;oBACrD,CAAC,CAAC;yBACD,KAAK,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;gBAC3B,CAAC;gBAED,gCAAU,GAAV,UAAW,EAAU;oBACpB,IAAI,IAAI,GAAG,IAAI,CAAC,cAAc,CAAC,EAAC,OAAO,EAAE,EAAE,EAAC,CAAC,CAAC;oBAC9C,IAAI,OAAO,GAAG,IAAI,cAAO,CAAC,EAAE,cAAc,EAAE,kDAAkD,EAAE,CAAC,CAAC;oBAClG,IAAI,OAAO,GAAG,IAAI,qBAAc,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;oBAEvD,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,wBAAwB,EAAE,IAAI,EAAE,OAAO,CAAC;yBAC5D,GAAG,CAAC,UAAA,GAAG,IAAI,OAAA,GAAG,CAAC,MAAM,EAAV,CAAU,CAAC;yBACtB,KAAK,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;gBAC3B,CAAC;gBAEO,iCAAW,GAAnB,UAAoB,KAAe;oBAClC,MAAM,CAAC,uBAAU,CAAC,KAAK,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,KAAK,IAAI,cAAc,CAAC,CAAC;gBAC/D,CAAC;gBAEO,oCAAc,GAAtB,UAAuB,GAAG;oBACzB,IAAI,GAAG,GAAG,EAAE,CAAC;oBACb,GAAG,CAAC,CAAC,IAAI,GAAG,IAAI,GAAG,CAAC,CACpB,CAAC;wBACA,EAAE,CAAC,CAAC,GAAG,CAAC,cAAc,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;4BAC7B,GAAG,IAAO,GAAG,SAAI,GAAG,CAAC,GAAG,CAAC,MAAG,CAAC;wBAC9B,CAAC;oBACF,CAAC;oBACD,MAAM,CAAC,GAAG,CAAC;gBACZ,CAAC;gBA5DF;oBAAC,iBAAU,EAAE;+BAEqB,aAAM,CAAC,sBAAa,CAAC;;+BAF1C;gBA6Db,kBAAC;YAAD,CA5DA,AA4DC,IAAA;YA5DD,qCA4DC,CAAA","file":"services/page.js","sourcesContent":["import {Injectable, Inject} from 'angular2/core';\nimport {Http, Response, Headers, RequestOptions} from 'angular2/http';\nimport {Observable} from 'rxjs/Observable';\nimport {Subject} from 'rxjs/Subject';\n\nimport {ConfigService} from './config';\n\n@Injectable()\nexport class PageModel {\n\tconstructor(\n\t\tpublic id: number,\n\t\tpublic weight: number,\n\t\tpublic template: string,\n\t\tpublic friendly_name?: string) { }\n}\n\n@Injectable()\nexport class PageService {\n\tconstructor(private http: Http, @Inject(ConfigService) private config) { }\n\n\tgetPages() {\n\t\treturn this.http.get(`/proposals/pages/${this.config.proposal_id}`)\n\t\t\t.map(res => {\n\t\t\t\treturn res.json().map((page) => {\n\t\t\t\t\treturn new PageModel(parseInt(page.id), parseInt(page.weight), page.template);\n\t\t\t\t})\n\t\t\t})\n\t\t\t.catch(this.handleError);\n\t}\n\n\tgetPageTemplates() {\n\t\treturn this.http.get(`/proposals/page_templates/${this.config.proposal_id}`)\n\t\t\t.map(res => {\n\t\t\t\treturn res.json().map((page) => {\n\t\t\t\t\treturn new PageModel(parseInt(page.id), parseInt(page.weight), page.template, page.friendly_name);\n\t\t\t\t})\n\t\t\t})\n\t\t\t.catch(this.handleError);\n\t}\n\n\taddPage(weight: number, template_id: number) {\n\t\tlet body = this.makePostString({proposal_id: this.config.proposal_id, weight: weight, template_id: template_id});\n\t\tlet headers = new Headers({ 'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8' });\n\t\tlet options = new RequestOptions({ headers: headers });\n\n\t\treturn this.http.post('/proposals/add_page', body, options)\n\t\t\t.map(res => { \n\t\t\t\tvar page = res.json();\n\t\t\t\treturn new PageModel(page.id, weight, page.template) \n\t\t\t})\n\t\t\t.catch(this.handleError);\n\t}\n\n\tremovePage(id: number) {\n\t\tlet body = this.makePostString({page_id: id});\n\t\tlet headers = new Headers({ 'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8' });\n\t\tlet options = new RequestOptions({ headers: headers });\n\n\t\treturn this.http.post('/proposals/remove_page', body, options)\n\t\t\t.map(res => res.status)\n\t\t\t.catch(this.handleError);\n\t}\n\n\tprivate handleError(error: Response) {\n\t\treturn Observable.throw(error.json().error || 'Server error');\n\t}\n\n\tprivate makePostString(obj) {\n\t\tlet str = '';\n\t\tfor (var key in obj)\n\t\t{\n\t\t\tif (obj.hasOwnProperty(key)) {\n\t\t\t\tstr += `${key}=${obj[key]}&`;\n\t\t\t}\n\t\t}\n\t\treturn str;\n\t}\n}"],"sourceRoot":"/source/"}